---
import ProductCard from "@components/ProductCard.astro";
import { getCollection } from "astro:content";
import { getLocaleByPath } from "astro:i18n";

interface Props {
	collection: "products";
}

const locale =
	Astro.currentLocale || getLocaleByPath(Astro.url.pathname) || "ar";

const { collection } = Astro.props;

const products = await getCollection(
	collection,
	({ slug, data }) => !data.nested && slug.startsWith(locale)
);
---

<div
	dir={locale == "ar" ? "rtl" : "ltr"}
	class="grid md:grid-cols-3 sm:grid-cols-2 overflow-x-clip grid-cols-1 gap-8 max-w-[1200px] w-[95%] md:w-full px-12 mx-auto my-[5rem]"
>
	{
		products
			.sort((a, b) => a.data.order - b.data.order)
			.map((product) => {
				return (
					<ProductCard
						title={product.data.title}
						model={product.data.model}
						production_rate={product.data.production_rate}
						production_unit={product.data.production_unit}
						cover={product.data.cover}
						slug={`/${collection == "products" ? "products" : "designs"}/${product.slug}`}
					/>
				);
			})
	}
</div>
